å‰‘æŒ‡Offerå…¸å‹é¢˜æ•´ç† - äº‰å–åšæœ€å¥½çš„é¢˜è§£

# LeetCode42-æ¥é›¨æ°´

`Hard` `åŒæŒ‡é’ˆ` 

æ•´ç†æ—¶é—´ï¼š2020å¹´02æœˆ25æ—¥



### 1 é¢˜ç›®æè¿°

ç»™å®š *n* ä¸ªéè´Ÿæ•´æ•°è¡¨ç¤ºæ¯ä¸ªå®½åº¦ä¸º 1 çš„æŸ±å­çš„é«˜åº¦å›¾ï¼Œè®¡ç®—æŒ‰æ­¤æ’åˆ—çš„æŸ±å­ï¼Œä¸‹é›¨ä¹‹åèƒ½æ¥å¤šå°‘é›¨æ°´ã€‚

![](./images/l-42.png)



**ç¤ºä¾‹**

```
è¾“å…¥: [0,1,0,2,1,0,1,3,2,1,2,1]
è¾“å‡º: 6
```



### 2 é¢˜è§£

è¿™é¢˜ä¸€çœ‹å°±æ¥è€…ä¸å–„ï¼Œæ»‘åŠ¨çª—å£å¥½åƒä¸å¤ªç®¡ç”¨ï¼ŒåŒæŒ‡é’ˆåˆæƒ³ä¸æ˜ç™½åº”è¯¥æ€ä¹ˆç”¨...

#### 2.1 ä¸€å±‚ä¸€å±‚è®¡ç®—

è¿™æ˜¯æˆ‘çœ‹åˆ°è¿™é“é¢˜æœ€å…ˆæƒ³åˆ°çš„åšæ³•ï¼Œä»ä¸‹å¾€ä¸Šä¸€å±‚ä¸€å±‚è®¡ç®—æ¯å±‚å¯ä»¥æ¥çš„é›¨æ°´ï¼ŒæŠŠç»“æœç´¯åŠ èµ·æ¥ä¸å°±å¥½äº†ï¼Œè€Œä¸”è¿™æ ·å°±å¯ä»¥ç›´æ¥ä½¿ç”¨å¯¹æ’æŒ‡é’ˆæ±‚è§£äº†ï¼äºæ˜¯æˆ‘é«˜å…´çš„å†™ä¸‹å¦‚ä¸‹ä»£ç ï¼Œæäº¤ä¹‹åå‘ç°ï¼š`314 / 315 ä¸ªé€šè¿‡æµ‹è¯•ç”¨ä¾‹`ğŸ™‚ï¼Œå‰©ä¸‹çš„ä¸€ä¸ªTLEäº†ï¼Œçœ‹æ ·å­è¿™ä¸ªæ–¹æ³•ä¸å¤ªè¡Œå‘€ã€‚

`C++ä»£ç `

```cpp
#include <algorithm>
class Solution {
public:
    int trap(vector<int>& height) {
        if (height.size() < 3) return 0;
        auto max_value = max_element(height.begin(), height.end());
        int ans = 0;
        for (int i = 1; i <= *max_value; i++) {
            int left = 0, right = height.size() - 1;
            while (height[left] < i) left ++;
            while (height[right] < i) right --;
            while (left < right) {
                if (height[left++] < i) ans += 1;
            }
        }
        return ans;
    }
};
```

*æ—¶é—´å¤æ‚åº¦$O(mÂ·n)$ï¼Œnä¸ºæ•°ç»„ä¸­æœ€å¤§æ•°å­—çš„å€¼ï¼Œç©ºé—´å¤æ‚åº¦$O(1)$ã€‚



`ä»¥ä¸‹åˆ†æå†…å®¹ä¸æ˜¯æˆ‘è‡ªå·±æƒ³å‡ºæ¥çš„ï¼Œæˆ‘å¤ªèœäº†orz`

#### 2.2 æš´åŠ›è§£å‘

æ—¢ç„¶ä¸Šé¢æŒ‰è¡Œçš„æ–¹æ³•è¡Œä¸é€šï¼Œé‚£å°±æŒ‰åˆ—å‘—ã€‚æœ€æš´åŠ›çš„è§£æ³•å°±æ˜¯ï¼šä»ç¬¬1åˆ—åˆ°ç¬¬n-2åˆ—ï¼ˆå‡è®¾å…±æœ‰nåˆ—ï¼‰è®¡ç®—æ¯ä¸€åˆ—èƒ½å¤Ÿå­˜å‚¨çš„æ°´é‡ã€‚

`C++ä»£ç `

```cpp
#include <algorithm>
class Solution {
public:
    int trap(vector<int>& height) {
        int ans = 0;
        // ä»ç¬¬1ä¸ªä½ç½®å¼€å§‹å‘å³ä¸€ä¸ªä¸€ä¸ªçš„ç®—ï¼Œæœ€å·¦è¾¹å’Œæœ€å³è¾¹è‚¯å®šå­˜ä¸ä½æ°´çš„ä¸ç”¨ç®—
        for (int i = 1; i < right; i++) {
            int l_max = 0, r_max = 0;
            // è®¡ç®—å·¦è¾¹[0,i]æœ€å¤§å€¼
            for (int j = i; i >= 0; j--) {
                l_max = max(l_max, height[j]);
            }
            // è®¡ç®—å³è¾¹[i,height.size() - 1]æœ€å¤§å€¼
            for (int j = i; j < height.size(); j++) {
                r_max = max(r_max, height[j]);
            }
            // è®¡ç®—å½“å‰åˆ—èƒ½å¤Ÿå­˜å¤šå°‘æ°´ï¼Œå·¦è¾¹æœ€å¤§å’Œå³è¾¹æœ€å¤§çš„è¾ƒå°å€¼å‡å»å½“å‰åˆ—æœ¬èº«çš„é«˜åº¦å³ä¸ºå­˜æ°´é‡
            ans += min(l_max, r_max) - height[i];
        }
        return ans;
    }
};
```

*æš´åŠ›è§£æ³•çš„æ—¶é—´å¤æ‚åº¦ä¸º$O(n^2)$ï¼Œç©ºé—´å¤æ‚åº¦ä¸º$O(1)$ã€‚



#### 2.3 åŠ ä¸Šå¤‡å¿˜å½•

å¦‚æœé¢è¯•å®˜çœ‹åˆ°ä½ å†™çš„è¿™ï¼Œè‚¯å®šè¯´ï¼šâ€ä½ ä¸è¡Œå•Šï¼Œè¿™é—­ç€çœ¼ç›éƒ½èƒ½å†™å‡ºæ¥â€œã€‚é‚£æ€ä¹ˆåŠå‘¢ï¼Ÿä»”ç»†è§‚å¯Ÿåï¼Œèƒ½å¤Ÿå‘ç°æš´åŠ›è§£æ³•ä¸­æ¯æ¬¡éƒ½éœ€è¦é‡å¤çš„è®¡ç®—[0, i]ä»¥åŠ[i, height.size() - 1]ä¹‹é—´çš„æœ€å¤§å€¼ï¼Œä½†å…¶å®æ¯æ¬¡æ‰«æçš„è¿‡ç¨‹ä¸­éƒ½æœ‰é‡å¤æ‰«æçš„åœ°æ–¹ï¼Œå¦‚æœèƒ½æŠŠä¹‹å‰æ‰«æè¿‡çš„åœ°æ–¹è®°ä¸‹æ¥ï¼Œé‚£ä¸å°±okkäº†å˜›ã€‚å› æ­¤å¯ä»¥ä½¿ç”¨å¤‡å¿˜å½•é™ä½æ—¶é—´å¤æ‚åº¦ï¼š

```cpp
#include <algorithm>
class Solution {
public:
    int trap(vector<int>& height) {
        if (height.size() == 0) return 0;
        vector<int> l_max(height.size() + 2), r_max(height.size() + 2);
        int ans = 0;
        // ä»å·¦å¾€å³éå†, l_max[i]å­˜å‚¨[0, i]åŒºé—´çš„æœ€å¤§å€¼
        for (int i = 1; i < height.size() + 1; i++) {
            l_max[i] = max(l_max[i - 1], height[i - 1]);
        }
        // ä»å³å¾€å·¦éå†, r_max[i]å­˜å‚¨[i, height.size() - 1]åŒºé—´çš„æœ€å¤§å€¼
        for (int i = height.size(); i > 0; i--) {
            r_max[i] = max(r_max[i + 1], height[i - 1]);
        }

        // ä»ç¬¬1ä¸ªä½ç½®å¼€å§‹å‘å³ä¸€ä¸ªä¸€ä¸ªçš„ç®—ï¼Œæœ€å·¦è¾¹å’Œæœ€å³è¾¹è‚¯å®šå­˜ä¸ä½æ°´çš„ä¸ç”¨ç®—
        for (int i = 1; i < height.size() - 1; i++) {
            // è®¡ç®—å½“å‰åˆ—èƒ½å¤Ÿå­˜å¤šå°‘æ°´ï¼Œå·¦è¾¹æœ€å¤§å’Œå³è¾¹æœ€å¤§çš„è¾ƒå°å€¼å‡å»å½“å‰åˆ—æœ¬èº«çš„é«˜åº¦å³ä¸ºå­˜æ°´é‡
            ans += min(l_max[i + 1], r_max[i + 1]) - height[i];
        }
        return ans;
    }
};
```

*æ—¶é—´å¤æ‚åº¦ä¸º$O(n)$ï¼Œç©ºé—´å¤æ‚åº¦ä¸º$O(n)$ã€‚



#### 2.4 åŒæŒ‡é’ˆæ³•

å¤‡å¿˜å½•çš„è§£æ³•è™½ç„¶èƒ½å¤ŸACï¼Œä½†è¿˜ä¸æ˜¯å¾ˆæ£’ï¼Œå› ä¸ºéœ€è¦å ç”¨$O(n)$çš„ç©ºé—´å»å­˜ä¸¤ä¸ªæ•°ç»„ã€‚ä½¿ç”¨åŒæŒ‡é’ˆçš„æ–¹æ³•èƒ½å¤Ÿåœ¨$O(1)$çš„æ—¶é—´å¤æ‚åº¦å†…è§£å†³è¿™ä¸ªé—®é¢˜ã€‚

```cpp
#include <algorithm>
class Solution {
public:
    int trap(vector<int>& height) {
        if (height.size() == 0) return 0;
        int n = height.size();
        int left = 0, right =n - 1;
        int ans = 0;

        int l_max = height[0], r_max = height[n - 1];
        
        while (left < right) {
            l_max = max(l_max, height[left]);
            r_max = max(r_max, height[right]);

            if (l_max <= r_max) ans += l_max - height[left++];
            else ans += r_max - height[right--];
        }
        return ans;
    }
};
```

*æ—¶é—´å¤æ‚åº¦ä¸º$O(n)$ï¼Œç©ºé—´å¤æ‚åº¦ä¸º$O(1)$ã€‚



é‚£ä¹ˆè¿™ä¸ªæ–¹æ³•æ˜¯ä¸ªä»€ä¹ˆåŸç†å‘¢ï¼Ÿä¸ºä»€ä¹ˆå®ƒå°±å¯è¡Œå‘¢ï¼Ÿåªå¯æ„ä¼šä¸å¯è¨€ä¼ ï¼Œæœ¬èœé¸¡æƒ³ä¸åˆ°è¿™ä¸ªæ–¹æ³•ï¼Œç›´æ¥çœ‹å›¾è§£å§ï¼š

![](./images/l-42.gif)

